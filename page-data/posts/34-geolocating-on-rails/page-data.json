{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts/34-geolocating-on-rails/","webpackCompilationHash":"8ad048b9041a01a887b8","result":{"data":{"site":{"siteMetadata":{"title":"Charlie Massry","author":"Charlie Massry"}},"markdownRemark":{"id":"492bc639-83d0-5841-b06f-6c350da1e374","excerpt":"In this day in age, 2014, websites using location services are becoming more and more common to better serve customers as they can provide a quicker, cleaner…","html":"<p>In this day in age, 2014, websites using location services are becoming more and more common to better serve customers as they can provide a quicker, cleaner user interface. But how is geolocation integrated into a Rails app? Well there are a couple of steps, first you must get the latitude and longitude coordinates as computers need these to be able to plot on a map, almost like the <a href=\"http://en.wikipedia.org/wiki/Cartesian_coordinate_system\">Cartesian Coordinate System</a> which you may or may not remember as the x y graph from Algebra in grade school. To turn an address into longitude and latitude coordinates, there’s a gem for that; I like the <a href=\"http://www.rubygeocoder.com\">Geocoder</a> gem. The Geocoder gem is simple to set up and has good documentation. To begin, in your Gemfile</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">gem &quot;geocoder&quot;</code></pre></div>\n<p>Then run</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ bundle install</code></pre></div>\n<p>The next part might be a little tricky as Geocoder depends on the database to store latitude and longitude coordinates, so you must create columns in your database as such. You can do this fairly easily with a migration</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ rails generate migration AddLocationDataToSchools latitude:float longitude:float</code></pre></div>\n<p>When you check the migration that is generated, you will get exactly what you want, just replace <code class=\"language-text\">Schools</code> in <code class=\"language-text\">AddLocationDataToSchools</code> to whatever your model name is; isn’t Rails awesome! Next, you must add it to your database, so run</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ rake db:migrate</code></pre></div>\n<p>Now that you have the database set up you can set it to work automatically, so in your model</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">geocoded_by :address\nafter_validation :geocode, if: :address_changed?</code></pre></div>\n<p>Now, your address will be converted to latitude and longitude coordinates after the record is created. A couple of things to note, you are limited in your number of requests per day for geolocating, also you must be connected to the Internet, which can be a pain during development. Stay tuned for tips on how to display a map with these coordinates. </p>","frontmatter":{"title":"Geolocating on Rails","date":"September 23, 2014"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/34-geolocating-on-rails/","previous":{"fields":{"slug":"/posts/33-angularjs-on-rails/"},"frontmatter":{"title":"AngularJS on Rails","id":33}},"next":{"fields":{"slug":"/posts/35-google-maps-on-rails/"},"frontmatter":{"title":"Google Maps on Rails","id":35}}}}}